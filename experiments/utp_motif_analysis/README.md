# uTP Motif Analysis

**Date:** January 11, 2026  
**Objective:** Analyze UCYN-A transit peptide (uTP) motif combinations and build a mature domain-based uTP variant predictor

---

## Background

This experiment replicates and formalizes analysis from earlier exploratory work on uTP motifs:

1. **Motif combination extraction**: Parse MEME output to identify conserved motif patterns within uTP sequences and characterize the 5 major uTP variants
2. **Mature domain predictor**: Train a classifier to predict uTP variant from the mature protein domain using ProtT5 embeddings

### Key Finding (from original analysis)

The mature protein domain can predict which uTP variant it will receive with ~68% accuracy (p=0.001 permutation test), suggesting co-evolution or a bipartite targeting system.

---

## Data Requirements

Copy these files from the old repository to `data/`:

```
data/
├── ucyn-a_enriched_cobalt_cleaned.fa   # MSA of uTP-containing proteins (required)
├── meme_gb.xml                         # MEME output with motif scan results (required)
├── good-c-term-full.fasta              # Full sequences (will be regenerated if missing)
└── good-c-term-gb.fasta                # Gblocks-filtered C-terms (optional)
```

### Input File Descriptions

| File                                | Description                                                                                       | Source            |
| ----------------------------------- | ------------------------------------------------------------------------------------------------- | ----------------- |
| `ucyn-a_enriched_cobalt_cleaned.fa` | Multiple sequence alignment of ~200 uTP-containing proteins from COBALT                           | Original analysis |
| `meme_gb.xml`                       | MEME motif discovery output (XML format) from running MEME on Gblocks-filtered C-terminal regions | MEME Suite        |

### Generated Files (do not need to copy)

- `mature-embeddings.h5` - ProtT5 embeddings (regenerated by script 2)
- `best-embedding-classifier.joblib` - Trained classifier (regenerated by script 2)

---

## Scripts

### 1. `motif_combination_extraction.py`

Parses MEME results and extracts motif combinations from uTP sequences.

**Outputs:**

- `output/motif_combinations.csv` - All motif combinations and their counts
- `output/top_utp_variants.csv` - Top 5 uTP variants with motif compositions
- `output/motif_positions.csv` - Relative positions of motifs
- `output/motif_combinations.svg` - Visualization of top variants
- `output/motif_tree.svg` - Motif transition graph

**Usage:**

```bash
cd /path/to/nitroplast
uv run python experiments/utp_motif_analysis/motif_combination_extraction.py
```

### 2. `utp_predictor.py`

Trains classifiers to predict uTP variant from mature domain embeddings.

**Outputs:**

- `output/mature-embeddings.h5` - ProtT5 embeddings for all mature domains
- `output/best-embedding-classifier.joblib` - Best trained classifier
- `output/classifier_results.csv` - Performance comparison of classifiers
- `output/roc_curve.svg` - ROC curve for best classifier
- `output/confusion_matrix.svg` - Confusion matrix

**Usage:**

```bash
cd /path/to/nitroplast
uv run python experiments/utp_motif_analysis/utp_predictor.py
```

**Note:** First run will download ProtT5 model (~3GB) and compute embeddings (~30 min on CPU).

---

## uTP Variants Summary

The analysis identifies 5 major uTP variants based on motif composition:

| Variant | Motif Pattern     | Prevalence |
| ------- | ----------------- | ---------- |
| uTP1    | 2 → 1 → 3 → 4     | ~30%       |
| uTP2    | 2 → 1 → 6 → 3 → 4 | ~15%       |
| uTP3    | 2 → 1 → 3 → 5     | ~12%       |
| uTP4    | 2 → 1 → 3 → 5 → 7 | ~8%        |
| uTP5    | 2 → 1 → 3 → 7     | ~6%        |

- **Motif 2** (21 aa): Initiating motif, present in 93% of sequences
- **Motif 1** (13 aa): Secondary fixed motif, present in 91%
- **Motifs 3-7**: Variable motifs appearing in different combinations

---

## Key Parameters

```python
# C-terminal region definition (in aligned coordinates)
C_TERM_START = 880  # Start of uTP region in MSA
C_TERM_END = 1010   # End of uTP region in MSA
MIN_COVERAGE = 0.6  # Minimum fraction of C-term region that must be non-gap

# Classifier parameters
MIN_OCCURRENCES = 10  # Minimum samples per class for classifier training
TEST_SIZE = 0.2       # Fraction held out for testing
N_PERMUTATIONS = 1000 # Permutation test iterations
```

---

## Results Interpretation

### Motif Combination Analysis

The motif tree shows that uTP sequences follow a constrained grammar:

- Almost all sequences start with motif 2 → motif 1
- After the fixed region, different branches lead to variants 3-7
- This suggests a modular targeting system

### Classifier Performance

| Classifier          | Accuracy | Permutation p-value | Interpretation                                       |
| ------------------- | -------- | ------------------- | ---------------------------------------------------- |
| Logistic Regression | 68%      | 0.001               | Strong evidence for mature domain → uTP relationship |
| Random Forest       | 68%      | 0.001               | Comparable performance                               |
| SVC                 | 45%      | 0.001               | Lower but still significant                          |
| Decision Tree       | 9%       | 0.038               | Near-random, overfitting                             |

The permutation test confirms that the classifier performs significantly better than chance, supporting the hypothesis that mature domain sequence predicts uTP variant.

---

## Synthetic uTP Construction

The scripts include functionality to construct synthetic uTP sequences:

```python
# Example: Generate uTP for a given variant
from motif_combination_extraction import construct_utp

motifs = ('motif_2', 'motif_1', 'motif_3', 'motif_4')  # uTP1 variant
synthetic_utp = construct_utp(motifs, motif_seqs, in_between_stats)
```

This can be used to design synthetic transit peptides for heterologous protein import experiments.

---

## Dependencies

- Python 3.12+
- BioPython
- pandas, numpy, matplotlib, seaborn
- scikit-learn
- transformers, torch (for ProtT5 embeddings)
- h5py (for embedding storage)
- graphviz (optional, for motif tree visualization)

---

## Reproducibility

```bash
# Full analysis pipeline
cd /path/to/nitroplast

# Step 1: Extract motif combinations
uv run python experiments/utp_motif_analysis/motif_combination_extraction.py

# Step 2: Train predictor (requires GPU recommended, ~30 min on CPU)
uv run python experiments/utp_motif_analysis/utp_predictor.py
```

---

## References

- Coale et al. (2024) - Original identification of uTP in 368 imported proteins
- MEME Suite - Bailey et al. (2015) - Motif discovery
- ProtT5 - Elnaggar et al. (2022) - Protein language model
